# ESET Smart Security Kernel Address Leak

* Affected Driver: epfw.sys 9.0.212.0 (ESET Personal Firewall Driver)

The issue exists on epwf.sys driver where you can basically interact whith the device created by this driver despite of the fact that the ACL restricts regular users from opening it. This happens because the call to IoCreateDevice doesn't set the FILE_DEVICE_SECURE_OPEN flag as part of the DeviceCharacteristics member. So a regular user can still open the device and bypass the ACL by calling CreateFile with the name of the device and any appended resource; ie. : CreateDeviceA("\\\\.\\epfw\\foo,...);

The driver IOCL dispatch routine has a function triggered on IOCTL code 0x8897226B that writes an internal kernel address of the driver itself to the outputbuffer. This allows a regular user to instantly know the base kernel address of the loaded driver.