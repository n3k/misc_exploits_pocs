# Trendmicro Internet Security 10 2016 BSOD

* Affected driver: tmnciesc.sys 3.0

The issue exists because the IOCTL Dispatch Routine of the driver tmnciesc.sys is not handling well IOCTL codes which doesn't exists. At the very end of the dispatch routine, the driver tries to write a value to the OutputBuffer (IRP->SystemBuffer); this pointer however will be null in the case of an IOCTL of type Neither. This produces a driver fault and ultimately, a BSOD.

![alt tag](https://github.com/n3k/misc_exploits_pocs/blob/master/Trendmicro_BSOD/bsod.PNG)
